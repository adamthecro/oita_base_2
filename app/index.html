<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="assets/leaflet.css">
    <title>OmsInTheAir</title>
</head>

<body class="alcentre">
    <div class="motorpow">
        <div class="motorpowbar" id="leftmotor"></div>
    </div>
    <div style="height: 100vh; width: 98vw">
        <div class="topbar"></div>
        <div class="header alcentre">
            <input type="text" class="commands" placeholder="Write command" id="input1">
            <div class="commbut alcentre" onclick="commbutf(0)">Sleep</div>
            <div class="commbut alcentre" onclick="commbutf(1)">Ping data</div>
            <div class="commbut alcentre" onclick="commbutf(2)">Base controll</div>
            <div class="commbut alcentre" onclick="commbutf(3)">LoRa</div>
            <div class="commbutr alcentre" onclick="commbutf(99)">Reboot</div>
        </div>

        <div class="data alcentre">
            <div class="logs">
                <!-- GLOBAL -->
                <div class="alcentre"
                    style="background-color: rgb(0, 0, 0); border: 1px solid rgb(26, 21, 49); border-radius:5px;">

                    <div class="delokos">
                        <div class="alcentre nene">Pitch G</div>
                        <div id="pg" class="alcentre datos" style="border-bottom-left-radius: 5px; ">Nan</div>
                    </div>
                    <div class="delokos">
                        <div class="alcentre nene">Roll G</div>
                        <div id="rg" class="alcentre datos">Nan</div>
                    </div>
                    <div class="delokos">
                        <div class="alcentre nene">Yaw G</div>
                        <div id="yg" class="alcentre datos" style="border-bottom-right-radius: 5px; ">Nan</div>
                    </div>
                </div><!-- MPU1 -->
                <div class="alcentre"
                    style="background-color: rgb(18, 45, 59); border: 1px solid rgb(26, 21, 49); border-radius:5px;margin-top: 1.75vh;">

                    <div class="delokos">
                        <div class="alcentre nene">Pitch 1</div>
                        <div id="p1" class="alcentre datos" style="border-bottom-left-radius: 5px; ">Nan</div>
                    </div>
                    <div class="delokos">
                        <div class="alcentre nene">Roll 1</div>
                        <div id="r1" class="alcentre datos">Nan</div>
                    </div>
                    <div class="delokos">
                        <div class="alcentre nene">Yaw 1</div>
                        <div id="y1" class="alcentre datos" style="border-bottom-right-radius: 5px; ">Nan</div>
                    </div>
                </div>
                <!-- MPU2 -->
                <div class="alcentre"
                    style="background-color: rgb(19, 54, 27); border: 1px solid rgb(26, 21, 49); border-radius:5px;margin-top: 1.75vh;">

                    <div class="delokos">
                        <div class="alcentre nene">Pitch 2</div>
                        <div id="p2" class="alcentre datos" style="border-bottom-left-radius: 5px; ">Nan</div>
                    </div>
                    <div class="delokos">
                        <div class="alcentre nene">Roll 2</div>
                        <div id="r2" class="alcentre datos">Nan</div>
                    </div>
                    <div class="delokos">
                        <div class="alcentre nene">Yaw 2</div>
                        <div id="y2" class="alcentre datos" style="border-bottom-right-radius: 5px; ">Nan</div>
                    </div>
                </div>
                <!-- MPU3 -->
                <div class="alcentre"
                    style="background-color: rgb(66, 28, 27); border: 1px solid rgb(26, 21, 49); border-radius:5px;margin-top: 1.75vh;">

                    <div class="delokos">
                        <div class="alcentre nene">Pitch 3</div>
                        <div id="p3" class="alcentre datos" style="border-bottom-left-radius: 5px; ">Nan</div>
                    </div>
                    <div class="delokos">
                        <div class="alcentre nene">Roll 3</div>
                        <div id="r3" class="alcentre datos">Nan</div>
                    </div>
                    <div class="delokos">
                        <div class="alcentre nene">Yaw 3</div>
                        <div id="y3" class="alcentre datos" style="border-bottom-right-radius: 5px; ">Nan</div>
                    </div>
                </div>
            </div>
            <div class="map" id="map_id"></div>
        </div>

        <div class="motors alcentre">
            <div class="motor alcentre">
                <div>
                    <div class="percentatge">
                        50
                    </div>
                    <div class="rpm">1278</div>
                </div>
            </div>
            <div class="angle alcentre" id="m1servo">60ยบ</div>
            <div class="spacer alcentre" id="spacer">
                <div id="stl_cont" style="width:100%;height:100%;margin-left:5%;" class="avionsito"></div>
            </div>
            <div class="angle alcentre" id="m2servo">60ยบ</div>
            <div class="motor alcentre">
                <div>
                    <div class="percentatge">
                        50
                    </div>
                    <div class="rpm">1278</div>
                </div>
            </div>
        </div>
        <div class="servos alcentre">
            <div class="servo">L-Wing <div class="rservo alcentre" id="lservo">60</div>
            </div>
            <div class="servo">R-Wing<div class="rservo alcentre" id="rservo">60</div>
            </div>
            <div class="servo">Package<div class="rservo alcentre" id="pservo">60</div>
            </div>
            <div class="servo">V-Elevator<div class="rservo alcentre" id="vservo">60</div>
            </div>
            <div class="servo">H-Elevator<div class="rservo alcentre" id="hservo">60</div>
            </div>
        </div>
        <div class="motorpowh alcentre">
            <div class="motorpowbarh" id="waybar"></div>
        </div>
    </div>
    <div class="motorpow">
        <div class="motorpowbar" id="rightmotor"></div>
    </div>
</body>
<script src="assets/jquery.js"></script>
<script src="stl_render/stl_viewer.min.js"></script>
<script>

    var pitch_m1 = 0;
    var pitch_m2 = 0;
    var pitch_m3 = 0;
    var pitch_gi = 0;
    var roll_m1 = 0;
    var roll_m2 = 0;
    var roll_m3 = 0;
    var roll_gi = 0;
    var yaw_m1 = 0;
    var yaw_m2 = 0;
    var yaw_m3 = 0;
    var yaw_gi = 0;
    var stl_viewer = new StlViewer(
        document.getElementById("stl_cont"), {
        allow_drag_and_drop: false,
        models: [{
            id: 0,
            filename: "yeye.STL",
            opacity: 0.8,
            z: 1,
            color: "#000",
            view_edges: true
        }, {
            id: 1,
            filename: "yeye.STL",
            opacity: 0.5,
            z: 1,
            color: "#122D3B",
        }, {
            id: 2,
            filename: "yeye.STL",
            opacity: 0.5,
            z: 1,
            color: "#13361B",
        }, {
            id: 3,
            filename: "yeye.STL",
            opacity: 0.5,
            z: 1,
            color: "#421C1B",
        },]
    }
    );
</script>
<script src="assets/leaflet.js"></script>
<script src="assets/maps.js"></script>
<script src="assets/gamepad.js"></script>
<script src="assets/socketio.js"></script>
<script>
    var socket = io("http://localhost:3000");
    setTimeout(function () {
        socket.on('planedata', function (msg) {
            stl_viewer.rotate(0, msg["pitch_gi"] - pitch_gi, msg["yaw_gi"] - yaw_gi, msg["roll_gi"] - roll_gi);
            stl_viewer.rotate(1, msg["pitch_m1"] - pitch_m1, msg["yaw_m1"] - yaw_m1, msg["roll_m1"] - roll_m1);
            stl_viewer.rotate(2, msg["pitch_m2"] - pitch_m2, msg["yaw_m2"] - yaw_m2, msg["roll_m2"] - roll_m2);
            stl_viewer.rotate(3, msg["pitch_m3"] - pitch_m3, msg["yaw_m3"] - yaw_m3, msg["roll_m3"] - roll_m3);

            pitch_m1 = msg["pitch_m1"];
            pitch_m2 = msg["pitch_m2"];
            pitch_m3 = msg["pitch_m3"];
            pitch_gi = msg["pitch_gi"];
            roll_m1 = msg["roll_m1"];
            roll_m2 = msg["roll_m2"];
            roll_m3 = msg["roll_m3"];
            roll_gi = msg["roll_gi"];
            yaw_m1 = msg["yaw_m1"];
            yaw_m2 = msg["yaw_m2"];
            yaw_m3 = msg["yaw_m3"];
            yaw_gi = msg["yaw_gi"];

            document.getElementById("pg").innerHTML = msg["pitch_gi"];
            document.getElementById("rg").innerHTML = msg["roll_gi"];
            document.getElementById("yg").innerHTML = msg["yaw_gi"];

            document.getElementById("p1").innerHTML = msg["pitch_m1"];
            document.getElementById("r1").innerHTML = msg["roll_m1"];
            document.getElementById("y1").innerHTML = msg["yaw_m1"];

            document.getElementById("p2").innerHTML = msg["pitch_m2"];
            document.getElementById("r2").innerHTML = msg["roll_m2"];
            document.getElementById("y2").innerHTML = msg["yaw_m2"];

            document.getElementById("p3").innerHTML = msg["pitch_m3"];
            document.getElementById("r3").innerHTML = msg["roll_m3"];
            document.getElementById("y3").innerHTML = msg["yaw_m3"];
        });
    }, 1000);
</script>

</html>